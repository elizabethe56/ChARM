# Build svc model

import src.preprocessing as pp
from src.tfidf_svc import TFIDF_SVC
from src.metrics import accuracy_score, confusion_matrix

M, F = pp.get_poems()
xt, xv, yt, yv = pp.train_val_split(M, F, 'poem_no_punct', 'gender', random_seed=2024)

svc_args = {'kernel':'rbf', 'C':1.75, 'gamma':'scale', 'random_state':2024}
svc = TFIDF_SVC(svc_args=svc_args)
svc.fit(xt, yt)
yhat = svc.predict(xv)
yhat
accuracy_score(yv, yhat)
confusion_matrix(yv, yhat)

